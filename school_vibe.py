import streamlit as st
import time

# --- é¡µé¢åŸºç¡€è®¾ç½® ---
st.set_page_config(
    page_title="å›½é™…é«˜ä¸­ç¥ä»™æŒ‡æ•°é‰´å®š",
    page_icon="ğŸ«",
    layout="centered"
)

# --- è‡ªå®šä¹‰æ ·å¼ (è®©ç•Œé¢æ›´å¥½çœ‹) ---
st.markdown("""
    <style>
    .main {
        background-color: #f0f2f6;
    }
    .stButton>button {
        width: 100%;
        background-color: #FF4B4B;
        color: white;
        font-weight: bold;
        border-radius: 10px;
        height: 50px;
    }
    .result-card {
        background-color: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        text-align: center;
        margin-top: 20px;
    }
    .big-score {
        font-size: 60px;
        font-weight: bold;
        color: #FF4B4B;
    }
    .tag-title {
        font-size: 24px;
        font-weight: bold;
        color: #333;
        margin-bottom: 10px;
    }
    </style>
""", unsafe_allow_html=True)

# --- æ ‡é¢˜åŒº ---
st.title("ğŸ« å›½é™…é«˜ä¸­â€œç¥ä»™æŒ‡æ•°â€é‰´å®š")
st.caption("ä½ çš„å­¦æ ¡æ˜¯éœæ ¼æ²ƒèŒ¨ï¼Œè¿˜æ˜¯ç¡¬æ ¸ä¿®è¡ŒåŸºåœ°ï¼Ÿæµ‹ä¸€æµ‹å°±çŸ¥é“ï¼")
st.markdown("---")

# --- ç¬¬ä¸€éƒ¨åˆ†ï¼šç”Ÿå­˜åŸºç¡€æ•°æ® (The Daily Grind) ---
st.subheader("ğŸ“ Step 1: ä½ çš„çœŸå®ç”Ÿå­˜çŠ¶æ€")
col1, col2 = st.columns(2)

with col1:
    sleep = st.slider("ğŸ˜´ æ—¥å‡ç¡çœ  (å«åˆä¼‘)", 3.0, 12.0, 7.0, 0.5, help="ç¡ä¸å¤Ÿ8å°æ—¶çœŸçš„ä¼šå˜ç¬¨å“¦")
    chill = st.slider("ğŸ“± æ¯æ—¥çº¯ç©æ‰‹æœº/æ‘¸é±¼æ—¶é•¿", 0.0, 10.0, 2.0, 0.5, help="é™¤å»ä¸Šè¯¾ã€ä½œä¸šã€ç¤¾å›¢åçš„è‡ªç”±æ—¶é—´")
    food = st.slider("ğŸ± é£Ÿå ‚æ»¡æ„åº¦ (1-5åˆ†)", 1, 5, 3, help="1åˆ†=ç”Ÿå­˜ç»´æŒï¼Œ5åˆ†=æƒ³æ‰“åŒ…å›å®¶")

with col2:
    homework = st.slider("ğŸ“š æ—¥å‡ä½œä¸š/åˆ·é¢˜æ—¶é•¿", 0.0, 10.0, 3.0, 0.5, help="åŒ…å«å†™æ–‡ä¹¦ã€åšProjectçš„æ—¶é—´")
    commute = st.slider("ğŸšŒ é€šå‹¤/å¼ºåˆ¶æ™šè‡ªä¹ æ—¶é•¿", 0.0, 6.0, 1.0, 0.5, help="è·¯ä¸Šå µè½¦ + è¢«æŒ‰åœ¨æ•™å®¤çš„æ—¶é—´")

# --- ç¬¬äºŒéƒ¨åˆ†ï¼šç¯å¢ƒæ°›å›´ç³»æ•° (The Vibe Check) ---
st.markdown("---")
st.subheader("ğŸ›ï¸ Step 2: å­¦æ ¡æ°›å›´åŠ æˆ")

# 1. ç”µå­äº§å“
tech_option = st.selectbox(
    "ğŸ“± ç”µå­äº§å“è‡ªç”±åº¦",
    ("è¿›æ ¡é—¨æ²¡æ”¶ (ä¸ä¸–éš”ç»)", "ä»…ç‰¹å®šåŒºåŸŸ/æ—¶æ®µå¯ç”¨", "å…¨å¤©è‡ªç”± (è‡ªæˆ‘ç®¡ç†)", "ç”µå­åŒ–æ•™å­¦ (iPad/Mac)"),
    index=1
)
tech_map = {"è¿›æ ¡é—¨æ²¡æ”¶ (ä¸ä¸–éš”ç»)": 0.8, "ä»…ç‰¹å®šåŒºåŸŸ/æ—¶æ®µå¯ç”¨": 1.0, "å…¨å¤©è‡ªç”± (è‡ªæˆ‘ç®¡ç†)": 1.1, "ç”µå­åŒ–æ•™å­¦ (iPad/Mac)": 1.2}

# 2. æ ¡å›­æ´»åŠ¨
event_option = st.selectbox(
    "ğŸ‰ æ ¡å›­æ´»åŠ¨ä¸°å¯Œåº¦",
    ("åªæœ‰å­¦ä¹  (è€ƒè¯•æœºå™¨)", "å¸¸è§„é…ç½® (å››å¤§èŠ‚)", "ç¤¾å›¢æå…¶ä¸°å¯Œ (é©¬æœ¯/ç”µç«ç­‰)", "ç»å¸¸å¤–å‡º (Field Trip/éœ²è¥)"),
    index=1
)
event_map = {"åªæœ‰å­¦ä¹  (è€ƒè¯•æœºå™¨)": 0.85, "å¸¸è§„é…ç½® (å››å¤§èŠ‚)": 1.0, "ç¤¾å›¢æå…¶ä¸°å¯Œ (é©¬æœ¯/ç”µç«ç­‰)": 1.1, "ç»å¸¸å¤–å‡º (Field Trip/éœ²è¥)": 1.15}

# 3. åŒå­¦æ°›å›´
peer_option = st.selectbox(
    "ğŸ¤ åŒå­¦äº’åŠ©æ°›å›´",
    ("æåº¦é«˜å‹ (å•æ‰“ç‹¬æ–—)", "ä¸¤æåˆ†åŒ– (å„ç©å„çš„)", "è‰¯æ€§ç«äº‰ (å…±åŒè¿›æ­¥)", "ç¥ä»™é˜Ÿå‹ (å…¨å‘˜å¤§ä½¬)"),
    index=2
)
peer_map = {"æåº¦é«˜å‹ (å•æ‰“ç‹¬æ–—)": 0.9, "ä¸¤æåˆ†åŒ– (å„ç©å„çš„)": 1.0, "è‰¯æ€§ç«äº‰ (å…±åŒè¿›æ­¥)": 1.1, "ç¥ä»™é˜Ÿå‹ (å…¨å‘˜å¤§ä½¬)": 1.2}

# 4. ç¡¬ä»¶è®¾æ–½
facility_option = st.selectbox(
    "ğŸŸï¸ æ ¡å›­ç¯å¢ƒä¸è®¾æ–½",
    ("å¤å¤é£/è€æ ¡åŒº", "æ ‡å‡†ç°ä»£åŒ–", "ç½‘çº¢æ‰“å¡çº§ (è½åœ°çª—/å’–å•¡å…)", "å¼€æ”¾å¼/å¤§å­¦åŸ (å¤–å–è‡ªç”±)"),
    index=1
)
facility_map = {"å¤å¤é£/è€æ ¡åŒº": 0.95, "æ ‡å‡†ç°ä»£åŒ–": 1.0, "ç½‘çº¢æ‰“å¡çº§ (è½åœ°çª—/å’–å•¡å…)": 1.1, "å¼€æ”¾å¼/å¤§å­¦åŸ (å¤–å–è‡ªç”±)": 1.15}

# 5. ç€è£…è‡ªç”±
style_option = st.selectbox(
    "ğŸ‘• ç€è£…ä¸ä¸ªæ€§åŒ–",
    ("ä¸¥æ ¼ç»Ÿä¸€ (å‘å‹éƒ½è¦ç®¡)", "å‘¨äº”ä¾¿æœæ—¥", "é€‚åº¦è‡ªç”± (å¯æŸ“å‘/é¦–é¥°)", "å®Œå…¨è‡ªç”± (æ¯æ—¥Tå°)"),
    index=1
)
style_map = {"ä¸¥æ ¼ç»Ÿä¸€ (å‘å‹éƒ½è¦ç®¡)": 0.9, "å‘¨äº”ä¾¿æœæ—¥": 1.0, "é€‚åº¦è‡ªç”± (å¯æŸ“å‘/é¦–é¥°)": 1.05, "å®Œå…¨è‡ªç”± (æ¯æ—¥Tå°)": 1.1}

# --- è®¡ç®—é€»è¾‘ ---
def calculate_score():
    # è·å–ç³»æ•°
    k1 = tech_map[tech_option]
    k2 = event_map[event_option]
    k3 = peer_map[peer_option]
    k4 = facility_map[facility_option]
    k5 = style_map[style_option]
    
    total_multiplier = k1 * k2 * k3 * k4 * k5
    
    # æ ¸å¿ƒå…¬å¼ (è°ƒæ•´äº†åˆ†æ¯å¸¸æ•°+4ï¼Œé˜²æ­¢åˆ†æ•°è¿‡äºæç«¯)
    # åˆ†å­ï¼šå¿«ä¹å› å­ (ç¡çœ  + æ‘¸é±¼ + åƒé¥­æƒé‡)
    numerator = sleep + chill + (food * 0.6) 
    # åˆ†æ¯ï¼šç—›è‹¦å› å­ (ä½œä¸š + é€šå‹¤ + åŸºç¡€ç”Ÿå­˜æŸè€—)
    denominator = homework + commute + 4.0 
    
    base_score = numerator / denominator
    final_score = base_score * total_multiplier
    
    return final_score

# --- æŒ‰é’®ä¸ç»“æœå±•ç¤º ---
st.markdown("###")
if st.button("ğŸ”¥ å¼€å§‹é‰´å®š ğŸ”¥"):
    with st.spinner('æ­£åœ¨åˆ†æä½ çš„ç”Ÿå­˜ç¯å¢ƒ...'):
        time.sleep(1.5) # å¢åŠ ä¸€ç‚¹ä»ªå¼æ„Ÿ
        
    score = calculate_score()
    
    # ç»“æœè¯„çº§é€»è¾‘
    if score < 0.8:
        title = "ğŸ§˜ ç¡¬æ ¸æ±‚å­¦è€…"
        desc = "å¤©å°†é™å¤§ä»»äºæ–¯äººä¹Ÿï¼ä½ çš„å­¦æ ¡ä¸»æ‰“ä¸€ä¸ªâ€œè‹¦å…¶å¿ƒå¿—â€ã€‚è™½ç„¶ç¯å¢ƒè‰°è‹¦ï¼Œä½†ç›¸ä¿¡ä»è¿™é‡Œèµ°å‡ºå»çš„ä½ ï¼ŒæŠ—å‹èƒ½åŠ›ç»å¯¹æ˜¯æ»¡çº§ï¼"
        color = "#8B0000" # æ·±çº¢
    elif 0.8 <= score < 1.2:
        title = "ğŸƒ å…¨èƒ½å¹³è¡¡æ‰‹"
        desc = "è¿™å°±æ˜¯æœ€çœŸå®çš„å›½é™…é«˜ä¸­ç”Ÿæ´»â€”â€”ç—›å¹¶å¿«ä¹ç€ã€‚ä½ åœ¨èµ¶Dueå’Œæ‘¸é±¼ä¹‹é—´æ‰¾åˆ°äº†å®Œç¾çš„å¹³è¡¡ç‚¹ï¼Œç»§ç»­ä¿æŒï¼"
        color = "#1E90FF" # è“
    elif 1.2 <= score < 1.6:
        title = "âœ¨ å‡¡å°”èµ›åŸä½æ°‘"
        desc = "ä½ çš„å­¦æ ¡å¤šå°‘æœ‰ç‚¹è®©äººå«‰å¦’äº†ã€‚è®¾æ–½å®Œå–„ã€æ°›å›´å¼€æ˜ï¼Œå»ºè®®å¥½å¥½çæƒœè¿™å‡ å¹´çš„ç¥ä»™æ—¥å­ï¼Œæ¯•ç«Ÿå¤§å­¦å¯èƒ½æ²¡è¿™ä¹ˆèˆ’æœã€‚"
        color = "#9370DB" # ç´«
    else:
        title = "ğŸ‘‘ å¤©é€‰ä¹‹å­"
        desc = "è¯·é—®è´µæ ¡è¿˜éœ€è¦å‰ç¥¥ç‰©å—ï¼Ÿè¿™ç§é…ç½®ç®€ç›´æ˜¯â€œå­¦æœ¯ç•Œçš„äº”æ˜Ÿçº§é…’åº—â€ã€‚è¯·åŠ¡å¿…æŠŠå­¦æ ¡åå­—ç•™åœ¨è¯„è®ºåŒºï¼Œè®©æˆ‘ä»¬å¼€å¼€çœ¼ï¼"
        color = "#FFD700" # é‡‘

    # æ˜¾ç¤ºç»“æœå¡ç‰‡
    st.markdown(f"""
        <div class="result-card">
            <div style="color: #888; font-size: 14px;">ä½ çš„å›½é™…å­¦æ ¡ç¥ä»™æŒ‡æ•°</div>
            <div class="big-score" style="color: {color}">{score:.2f}</div>
            <div class="tag-title" style="color: {color}">{title}</div>
            <p style="font-size: 16px; color: #555; margin-top: 15px;">{desc}</p>
        </div>
    """, unsafe_allow_html=True)
    
    st.balloons()
    st.info("ğŸ’¡ æˆªå›¾åˆ†äº«ç»™åŒå­¦ï¼Œçœ‹çœ‹è°çš„å­¦æ ¡æ›´â€œç¥ä»™â€ï¼")

# --- åº•éƒ¨ç‰ˆæƒ ---
st.markdown("---")
st.caption("Created by Mr. [Your Name] | ä»…ä¾›å¨±ä¹ï¼Œå¥½å¥½å­¦ä¹ ")
